<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn">
<meta http-equiv="X-UA-Compatible" content="IE=7" />
<head>  
</head>
<body onload="contentLoad()">


     <object classid="clsid:6CA705D0-BB6E-46DF-BE44-64809B0B0E36" id=VIDEOCAP CODEBASE="*.cab#version=0,0,0,0"  width=640 height=480> 
     </object>
     <script   LANGUAGE=JavaScript>



         var idx = 0;
         var str_houzui = "jpg";
         var Directory = "C:\\currentDir\\1\\";
         var AutoGrapPath = "C:\\currentDir";
         function start_preview() {
             VIDEOCAP.StartPreview();
         }

         function start_MainCampreview(url) {
             VIDEOCAP.ReSetUpDevice(0);

             var num = VIDEOCAP.GetColorSpaceOutputsizeNum(0);

             var selindex = 0;
             var width = VIDEOCAP.GetMediaWidth();

             var height = VIDEOCAP.GetMediaHeight();

             for (i = 0; i < num; i++) {
                 var w = VIDEOCAP.GetOutPutSizeWidth(0, i);
                 var h = VIDEOCAP.GetOutPutSizeHeight(0, i);
                 var str = w.toString() + "X" + h.toString();
                 addoption(str);
                 if (w == width) selindex = i;
             }
             seloption(selindex);             
         }

         function start_SubCampreview() {
             VIDEOCAP.ReSetUpDevice(1);

             var num = VIDEOCAP.GetColorSpaceOutputsizeNum(0);

             var selindex = 0;
             var width = VIDEOCAP.GetMediaWidth();

             var height = VIDEOCAP.GetMediaHeight();

             for (i = 0; i < num; i++) {
                 var w = VIDEOCAP.GetOutPutSizeWidth(0, i);
                 var h = VIDEOCAP.GetOutPutSizeHeight(0, i);
                 var str = w.toString() + "X" + h.toString();
                 addoption(str);
                 if (w == width) selindex = i;
             }
             seloption(selindex);
         }
         function stop_preview(url) {

             VIDEOCAP.StopPreview();
         }

         function contentLoad() {

             str_houzui = "jpg";
             addoption1("彩色");
             addoption1("灰度");
             addoption1("黑白");
             seloption1(0);

             addoption2("JPG");
             addoption2("TIF");
             addoption2("PNG");
             addoption2("BMP");
             seloption2(0);



             addoption3("200");
             addoption3("300");
             addoption3("400");
             addoption3("500");
             seloption3(0);


             


         }

         function addoption(s) {
             var obj = document.getElementById("sel").options;
             var opt = new Option(s, obj.length);
             obj.options.add(opt);
         }
         function addoption1(s) {
             var obj = document.getElementById("picsel").options;
             var opt = new Option(s, obj.length);
             obj.options.add(opt);
         }

         function seloption(index) {
             var objSelect = document.getElementById("sel").options;
             objSelect.options[index].selected = true;
         }



         function seloption1(index) {
             var objSelect = document.getElementById("picsel").options;
             objSelect.options[index].selected = true;
         }
         function ShowVideoProperty(url) {
             VIDEOCAP.ShowVideoPropertyPage();
         }

         function ZoomIn() {

             VIDEOCAP.ZoomIn();
         }
         function ZoomOut() {

             VIDEOCAP.ZoomOut();
         }

         function addoption2(s) {
             var obj = document.getElementById("formatsel").options;
             var opt = new Option(s, obj.length);
             obj.options.add(opt);
         }

         function seloption2(index) {
             var objSelect = document.getElementById("formatsel").options;
             objSelect.options[index].selected = true;
         }


         
         function addoption3(s) {
             var obj = document.getElementById("limitfilesizeSel").options;
             var opt = new Option(s, obj.length);
             obj.options.add(opt);
         }

         function seloption3(index) {
             var objSelect = document.getElementById("limitfilesizeSel").options;
             objSelect.options[index].selected = true;
         }
         function ShowVideoFormat(url) {
             VIDEOCAP.ShowVideoPinPropertyPage();
         }
         function Fit(url) {
             VIDEOCAP.VideoFit();
         }
         function Fill(url) {
             VIDEOCAP.VideoFill();
         }

         function onmouse_wheel() {
             // VIDEOCAP.OnMouseWheel1(event.wheelDelta);

         }
         function EnAutoRange(url) {
             VIDEOCAP.EnableAuto_Range(1);
         }
         function DisAutoRange(url) {
             VIDEOCAP.EnableAuto_Range(0);
         }
         function Takepic(url) {
             
             var Path = Directory + "1." + str_houzui;
                    
             VIDEOCAP.SetCurrentPicPath(Directory);
             VIDEOCAP.SetJpgQuality(65);                  //设置JPEG压缩比， 0~100，100为不压缩。
             VIDEOCAP.SetPicDpi(300);                     //设置DPI             
             VIDEOCAP.TakePicture(Path);
             
         }
         


         function changeoutputsize() {


             var obj = document.getElementById("sel").options;

             num = VIDEOCAP.GetColorSpaceOutputsizeNum(0);

             var selindex;
             var x = obj.selectedIndex;

             if (x < num) {

                 var w = VIDEOCAP.GetOutPutSizeWidth(0, x);
                 var h = VIDEOCAP.GetOutPutSizeHeight(0, x);                 
                 VIDEOCAP.SetVideoOutpsize(w, h);
             }
             else window.alert("Out of  Range");



         }
         function PicType() {
             var obj = document.getElementById("formatsel").options;
             var x = obj.selectedIndex;



         }

         function RotateLeft(url) {
             VIDEOCAP.RotateLeft();

         }

         function RotateRight(url) {
             VIDEOCAP.RotateRight();
         }


        



         function TakePicType() {


             var obj = document.getElementById("picsel").options;


             var selindex;
             var x = obj.selectedIndex;

             if (x == 1) VIDEOCAP.SetTakeColorMode(1, 0);
             if (x == 2) VIDEOCAP.SetTakeColorMode(0, 0);
             if (x == 0) VIDEOCAP.SetTakeColorMode(2, 0);



         }


        


         function LimitFile(obj) {
             if (obj.checked) {
                 VIDEOCAP.EnableLimitFileSize(1);
                 var obj = document.getElementById("limitfilesizeSel").options;
                 var x = obj.selectedIndex;

                 if (x == 0) VIDEOCAP.SetLimitFileSize(200);
                 if (x == 1) VIDEOCAP.SetLimitFileSize(300);
                 if (x == 2) VIDEOCAP.SetLimitFileSize(400);
                 if (x == 3) VIDEOCAP.SetLimitFileSize(500);

             }
             else {
                 VIDEOCAP.EnableLimitFileSize(0);


             }
         }

         function limitfilesize() {
             var obj = document.getElementById("limitfilesizeSel").options;
             var x = obj.selectedIndex;

             if (x == 0) VIDEOCAP.SetLimitFileSize(200);
             if (x == 1) VIDEOCAP.SetLimitFileSize(300);
             if (x == 2) VIDEOCAP.SetLimitFileSize(400);
             if (x == 3) VIDEOCAP.SetLimitFileSize(500);


         }
         function PicType() {
             VIDEOCAP.EnableLimitFileSize(1);
             /*var   obj=document.getElementById("formatse").options; 
             var   x = obj.selectedIndex; 
                  
             if(x==0) str_houzui="jpg";
             if(x==1) str_houzui="tif";
             if(x==2) str_houzui="png";
             if(x==3) str_houzui="bmp";*/
             var x = document.frm1.formatsel.selectedIndex;
             if (x == 0) str_houzui = "jpg";
             if (x == 1) str_houzui = "tif";
             if (x == 2) str_houzui = "png";
             if (x == 3) str_houzui = "bmp";
             //alert(str_houzui);

         }



         function StartRecord() {
             VIDEOCAP.StartRecord("C:\\1.wmv");
         }

         function StopRecord() {
             VIDEOCAP.StopRecord();
         }


         function StartWMVRecord() {
             VIDEOCAP.StartRecordAudio("C:\\1.wma");
         }


         function StopWMVRecord() {
             VIDEOCAP.StopRecordAudio();
         }

         function PDF() {
             VIDEOCAP.PDF_Init("C:\\1.jpg");
             VIDEOCAP.PDF_Add("C:\\2.jpg");
             VIDEOCAP.PDF_Save("C:\\hecheng.pdf");
         }

         document.onmousewheel = onmouse_wheel;

         function Buttonpdf_onclick() {
             PDF();
         }

         function Checkbox2_onclick(obj) {
             if (obj.checked) {
                // alert(AutoGrapPath);
                 VIDEOCAP.startAutoTake(0, 0, AutoGrapPath);
             }
             else {
                 VIDEOCAP.stopAutoTake();
             }
         }

         function Checkbox3_onclick(obj) {

             if (obj.checked) {
                 EnAutoRange();
             }
             else {
                 DisAutoRange();
             }
         }

     </script> 


  





     <form name="frm1">  

     

     
    
     <input   TYPE="button"   VALUE="主摄像头"   onClick="start_MainCampreview()"> 
     <input   TYPE="button"   VALUE="副摄像头"   onClick="start_SubCampreview()"> 
     <input   TYPE="button"   VALUE="开始预览"   onClick="start_preview()">      
     <input   TYPE="button"   VALUE="停止预览"   onClick="stop_preview()"> 
     <input   TYPE="button"   VALUE="视频属性"   onClick="ShowVideoProperty()"> 
     <input   TYPE="button"   VALUE="视频格式"   onClick="ShowVideoFormat()"> 
     <input   TYPE="button"   VALUE="视频适合"       onClick="Fit()"> 
     <input   TYPE="button"   VALUE="视频填充"       onClick="Fill()"> <br><br>

	  <input   TYPE="button"   VALUE="拍照"   onClick="Takepic()">  
      <input   TYPE="button"   VALUE="左旋"       onClick="RotateLeft()"> 
     <input   TYPE="button"   VALUE="右旋"        onClick="RotateRight()"> 
     <input   TYPE="button"   VALUE="放大"   onClick="ZoomIn()"> 
       <input   TYPE="button"   VALUE="缩小"   onClick="ZoomOut()">
     <input id="Buttonpdf" type="button" value="合成PDF" onclick="return Buttonpdf_onclick()" />&nbsp;&nbsp;
     <input id="Checkbox2" type="checkbox" onclick="Checkbox2_onclick(this)" />抓拍&nbsp; 
     <input id="Checkbox3" type="checkbox" onclick="Checkbox3_onclick(this)" />纠偏<br>
	   <br>
     
	 <input   TYPE="button"   VALUE="开始录像"   onClick="StartRecord()"> 
	   <input   TYPE="button"   VALUE="停止录像"   onClick="StopRecord()"> 
	   <input   TYPE="button"   VALUE="开始录音"   onClick="StartWMVRecord()"> 
	   <input   TYPE="button"   VALUE="停止录音"   onClick="StopWMVRecord()"> 
       
    
     
        
     
       
  
       

	   
  
   
       

     </form>   
        
      <form> 
      图片格式<select name="formatsel"  onchange="PicType()" > 	  
      </select>视频输出大小<select name="sel"  onchange="changeoutputsize()">    
      
       </select>拍照图片类型<select name="picsel"  onchange="TakePicType()">
      </select>文件大小<select name="limitfilesizeSel"  onchange="limitfilesize()">         
      </select>K字节<input id="Checkbox1" type="checkbox" onclick="LimitFile(this)" />限制文件大小拍照</form> 
      <!--<input type="checkbox"  onclick="LimitFile(this);">限制文件大小拍照   -->

</body>
  
</html> 
